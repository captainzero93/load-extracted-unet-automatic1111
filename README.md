# UNet Loader / merge Plugin for AUTOMATIC1111's Stable Diffusion Web UI

This plugin allows you to load separate UNet and non-UNet parts of Stable Diffusion models, offering significant space-saving benefits and flexibility in model management. Automatic1111 plugin based off my [UNet Extractor and Remover tool](https://github.com/captainzero93/extract-unet-safetensor)

## Why Use UNet Loader?

1. **Space Efficiency**: Full checkpoints bundle the UNet, CLIP, VAE, and text encoder together. By using separate UNet files, you can reuse the same text encoder and other components for multiple models, saving gigabytes of space per additional model.

2. **Practical Benefits**: For large models like SDXL or FLUX, multiple full checkpoints can quickly consume tens of gigabytes. Using extracted UNets instead can significantly reduce storage requirements.

3. **Future-Proofing**: As models continue to grow in complexity, the space-saving benefits of using separate UNets may become even more significant.

## Features

- Load separate UNet and non-UNet SafeTensors files
- Combine UNet and non-UNet parts on-the-fly
- Supports SD 1.5, SDXL, and FLUX models
- Efficient VRAM management
- Easy-to-use interface integrated into AUTOMATIC1111's Web UI

## Installation

1. Navigate to the `extensions` folder in your AUTOMATIC1111 Stable Diffusion Web UI installation.
2. Clone this repository:
   ```
   git clone https://github.com/captainzero93/load-extracted-unet-automatic1111.git
   ```
3. Restart the Web UI.

## Usage

1. Extract UNet files from your full model checkpoints using the [UNet Extractor and Remover tool](https://github.com/captainzero93/extract-unet-safetensor). This plugin is specifically tested with safetensor format files created by this tool.
2. Rename your extracted UNet files descriptively (e.g., "sd15_animestyle_unet.safetensors").
3. Place your files in the `extensions/unet-loader-plugin/models` folder.
4. In the Web UI, navigate to the "UNet Loader" tab.
5. Select your UNet file from the "UNet File" dropdown.
6. Select a non-UNet file (containing CLIP, VAE, etc.) from the "Non-UNet File" dropdown.
7. Click "Load Model Parts" to combine and load the model.
8. The combined model will now be available for use in txt2img and img2img tabs.

## Compatibility

This plugin is designed to work with safetensor format files created by the [UNet Extractor and Remover tool](https://github.com/captainzero93/extract-unet-safetensor). While it may work with other safetensor files, it has been specifically tested and verified with files generated by this tool. For best results and compatibility, I recommend using UNet and non-UNet files extracted using the UNet Extractor and Remover tool.

## Tips for Optimal Use

- Keep one copy of the non-UNet parts (CLIP, VAE, etc.) for each model type (SD 1.5, SDXL, FLUX).
- Store multiple UNet files for different models of the same type.
- Use descriptive names for your UNet files to easily identify them.
- The plugin will display the currently loaded model combination in the UNet Loader tab.

## How It Works

1. When you select a UNet file and a non-UNet file, the plugin loads both parts into memory.
2. It combines these parts to create a full model.
3. The combined model is then set as the active model for generation.

## Troubleshooting

- If you experience slow generation times, try restarting the Web UI to clear VRAM.
- Ensure your GPU has enough VRAM to hold the combined model.
- Check the console output for any error messages if the plugin isn't working as expected.
- Make sure you're using UNet and non-UNet files extracted with the UNet Extractor and Remover tool for guaranteed compatibility.

## Contributing

Contributions, issues, and feature requests are welcome! Feel free to check the issues page or submit a PR.

## License

This project is licensed under the MIT License with an additional attribution requirement. This means you are free to use, modify, and distribute this software, provided that you include the following attribution in your project:

```
This project uses UNet Extractor and Remover for Stable Diffusion 1.5, SDXL, and FLUX by Joe Faulkner (captainzero93).
Original work: https://github.com/captainzero93/extract-unet-safetensor
```

See the [LICENSE](LICENSE) file for the full terms of the MIT License.

## Disclaimer

This plugin is provided as-is, without any warranties or guarantees. Always ensure you have the right to use and modify the model files you're working with. The authors are not responsible for any misuse or copyright infringement resulting from the use of this plugin.

## Acknowledgements

- This plugin is designed to work with files created by the [UNet Extractor and Remover tool](https://github.com/captainzero93/extract-unet-safetensor) by Joe Faulkner (captainzero93).
- Thanks to the AUTOMATIC1111 Stable Diffusion Web UI community for support and feedback.
- Special thanks to all the contributors to the main project.
